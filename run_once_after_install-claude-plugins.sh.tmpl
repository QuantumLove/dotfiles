#!/bin/bash
# Clone Claude Code plugin marketplaces if not present
# This script runs once after chezmoi apply

set -e

PLUGINS_DIR="$HOME/.claude/plugins/marketplaces"
mkdir -p "$PLUGINS_DIR"

echo "ðŸ”Œ Installing Claude Code plugins..."
echo ""

clone_if_missing() {
  local name="$1"
  local repo="$2"
  if [ ! -d "$PLUGINS_DIR/$name" ]; then
    echo "ðŸ“¦ Cloning $name..."
    git clone --depth 1 "https://github.com/$repo.git" "$PLUGINS_DIR/$name" 2>/dev/null
    echo "   âœ… Installed"
  else
    echo "âœ… $name already installed"
  fi
}

clone_if_missing "claude-plugins-official" "anthropics/claude-plugins-official"
clone_if_missing "compound-engineering-plugin" "EveryInc/compound-engineering-plugin"
clone_if_missing "superpowers-marketplace" "obra/superpowers-marketplace"

echo ""
echo "ðŸŽ‰ Claude Code plugins ready!"
echo "   Restart Claude Code to use new plugins."
